(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{14657:(e,t,s)=>{"use strict";s.d(t,{e:()=>c});var a=s(95155),n=s(12115),r=s(28916),l=s(51907),o=s(71365);function i(e){let t,{time:s,level:n,thread:o,source:i,line:c,simple:d,visible:u}=e,x=i.split("."),f=x[x.length-1];switch(n){case"INFO":t="text-green-700 dark:text-green-500";break;case"WARN":t="text-yellow-700 dark:text-yellow-600";break;case"ERROR":t="text-red-700 dark:text-red-400"}return(0,a.jsxs)("p",{className:(0,l.cn)("text-xs text-nowrap font-[Consolas] space-x-1",u?"":"hidden"),children:[(0,a.jsx)("span",{className:"text-blue-500 dark:text-blue-400",children:"[".concat((0,r.GP)(new Date(s),"HH:mm:ss"),"]")}),!d&&(0,a.jsx)("span",{className:t,children:"[".concat(o,"/").concat(n,"]")}),!d&&(0,a.jsx)("span",{className:"text-emerald-600 dark:text-emerald-500",children:"(".concat(f,")")}),(0,a.jsx)("span",{children:c})]})}function c(e){let{client:t,simple:s,level:r,className:c}=e,d=(0,n.useRef)(null),[u,x]=(0,n.useState)([]),f=e=>{x(t=>[...t,e])},m=()=>{d.current&&(d.current.innerHTML="")};return(0,n.useEffect)(()=>{if(!d.current)return;let e=d.current;e.scrollTo({top:e.scrollHeight})},[u]),(0,n.useEffect)(()=>{if(t)return t.onMessage((e,t)=>{switch(e){case"init":for(let e of t)f(e);break;case"log":f(t)}}),()=>m()},[t]),(0,a.jsx)("div",{className:(0,l.cn)(c,"border rounded-sm bg-background overflow-auto p-2"),ref:d,children:u.map((e,t)=>(0,n.createElement)(i,{...e,simple:s,visible:(0,o.k)(e.level)>=(0,o.k)(null!=r?r:o.I),key:t}))})}},24232:(e,t,s)=>{"use strict";s.d(t,{C:()=>f});var a=s(95155);s(12115);var n=s(13052),r=s(51907);function l(e){let{...t}=e;return(0,a.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...t})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,r.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,r.cn)("inline-flex items-center gap-1.5",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,r.cn)("text-foreground font-normal",t),...s})}function d(e){let{children:t,className:s,...l}=e;return(0,a.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,r.cn)("[&>svg]:size-3.5",s),...l,children:null!=t?t:(0,a.jsx)(n.A,{})})}var u=s(76037),x=s(71196);function f(e){let{children:t,title:s,subTitle:n,icon:f,className:m}=e;return(0,a.jsxs)("div",{className:"px-16 flex-1 flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"pt-10 pb-5 flex flex-col gap-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(x.SidebarTrigger,{className:"cursor-pointer"}),(0,a.jsx)(u.Separator,{orientation:"vertical"}),(0,a.jsx)(l,{children:(0,a.jsxs)(o,{children:[(0,a.jsx)(i,{children:"OPanel"}),(0,a.jsx)(d,{}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{children:s}),(0,a.jsx)(d,{})]}),(0,a.jsx)(i,{children:(0,a.jsx)(c,{children:null!=n?n:s})})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-5",children:[f,(0,a.jsx)("h1",{className:"text-3xl font-bold",children:null!=n?n:s})]})]}),(0,a.jsx)("div",{className:(0,r.cn)(m,"pb-16"),children:t})]})}},31886:(e,t,s)=>{"use strict";s.d(t,{$M:()=>i,nl:()=>d,ow:()=>c,qV:()=>o,y0:()=>r,yq:()=>l});var a=s(23464),n=s(16453);let r="",l=globalThis.window?"ws://".concat(window.location.host):"ws://localhost:3000";async function o(e){return(await a.A.request({method:"get",url:r+e,headers:{"X-Credential-Token":(0,n.getCookie)("token")}})).data}async function i(e,t){let s=t?JSON.stringify(t):"";return(await a.A.request({method:"post",maxBodyLength:1/0,url:r+e,headers:{"Content-Type":"text/plain"},data:s})).data}async function c(e,t){let s=t?JSON.stringify(t):"";return(await a.A.request({method:"post",maxBodyLength:1/0,url:r+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,n.getCookie)("token")},data:s})).data}async function d(e,t){let s=t?JSON.stringify(t):"";return(await a.A.request({method:"delete",maxBodyLength:1/0,url:r+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,n.getCookie)("token")},data:s})).data}},55424:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(12115),n=s(56671),r=s(31886);class l{init(){var e,t,s;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected.")}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e)}),null==(s=this.socket)||s.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:s,data:a}=JSON.parse(t.data);if(console.log("[Terminal] "+a.line),"init"===s&&!(a instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===s)throw n.oR.error("Packet Error",{description:a}),Error("Packet error: "+a);e(s,a)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){this.socket=null,this.socket=new WebSocket(r.yq+"/terminal"),this.init()}}function o(){let[e,t]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=new l;return t(e),()=>e.close()},[]),e}},59505:(e,t,s)=>{Promise.resolve().then(s.bind(s,82684))},71365:(e,t,s)=>{"use strict";s.d(t,{I:()=>a,k:()=>n});let a="INFO";function n(e){switch(e){case"INFO":return 1;case"WARN":return 2;case"ERROR":return 3}}},82684:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var a=s(95155),n=s(12115),r=s(62978),l=s(54416),o=s(39881),i=s(62525),c=s(56671),d=s(24232),u=s(55424),x=s(14657),f=s(97168),m=s(45772),p=s.n(m);let h=n.createContext(void 0);var g=s(89852),v=s(51907);function j(e){let{name:t,selected:s,index:r}=e,{value:l,setSelected:o,complete:i}=(0,n.useContext)(h);return(0,a.jsxs)(f.$,{variant:"ghost",className:"block h-fit p-1 rounded-xs text-sm text-left font-[Consolas] cursor-pointer hover:bg-transparent active:bg-muted data-[selected=true]:!bg-muted","data-selected":s,onClick:()=>o(r),onDoubleClick:()=>i(),children:[(0,a.jsx)("span",{className:"font-bold",children:l}),(0,a.jsx)("span",{children:t.replace(l,"")})]})}function b(e){var t,s;let{itemList:r,onInput:l,ref:o,...i}=e,[c,d]=(0,n.useState)(""),[u,x]=(0,n.useState)(0),[f,m]=(0,n.useState)(0),[b,w]=(0,n.useState)(r),[k,N]=(0,n.useState)(null),y=0===c.length||0===b.length,C=async()=>{var e;if(!o.current)return;let t=await (0,v.LJ)(w),s=await (0,v.LJ)(N),a=await (0,v.LJ)(d);if(null===s)return;let n=t[s].replace((0,v.eg)(a,null!=(e=o.current.selectionStart)?e:0),"");o.current.value=a+n,d(a+n)};return(0,n.useEffect)(()=>{w(r)},[r]),(0,n.useEffect)(()=>{var e;if(!o.current)return;let t=o.current,s=t.getBoundingClientRect();x(s.top+s.height+2),m(t.offsetLeft+p()(t,null!=(e=t.selectionStart)?e:0).left);let a=[],n=t.selectionStart;for(let e of r)e.startsWith((0,v.eg)(c,null!=n?n:0))&&a.push(e);w(a),N(a.length>0?0:null)},[c,r,o]),(0,n.useEffect)(()=>{document.body.addEventListener("keydown",async e=>{let t=await (0,v.LJ)(w),s=await (0,v.LJ)(N);switch(e.key){case"Tab":if(null===s||!o.current)return;e.preventDefault(),C();break;case"ArrowUp":if(null===s)return;e.preventDefault(),N(s>0?s-1:t.length-1);break;case"ArrowDown":if(null===s)return;e.preventDefault(),N(s<t.length-1?s+1:0)}})},[]),(0,a.jsxs)(h.Provider,{value:{value:(0,v.eg)(c,null!=(s=null==(t=o.current)?void 0:t.selectionStart)?s:0),setSelected:N,complete:C},children:[(0,a.jsx)(g.p,{...i,onInput:e=>{d(e.target.value),l&&l(e)},ref:o}),(0,a.jsx)("div",{className:(0,v.cn)("absolute flex flex-col bg-popover min-w-40 w-fit max-h-32 p-1 border rounded-sm overflow-y-auto",y?"hidden":""),style:{top:u,left:f},children:b.map((e,t)=>(0,a.jsx)(j,{name:e,selected:k===t,index:t},t))})]})}var w=s(88482),k=s(14582),N=s(66474),y=s(5196),C=s(47863);function E(e){let{...t}=e;return(0,a.jsx)(k.bL,{"data-slot":"select",...t})}function S(e){let{...t}=e;return(0,a.jsx)(k.WT,{"data-slot":"select-value",...t})}function z(e){let{className:t,size:s="default",children:n,...r}=e;return(0,a.jsxs)(k.l9,{"data-slot":"select-trigger","data-size":s,className:(0,v.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r,children:[n,(0,a.jsx)(k.In,{asChild:!0,children:(0,a.jsx)(N.A,{className:"size-4 opacity-50"})})]})}function R(e){let{className:t,children:s,position:n="popper",...r}=e;return(0,a.jsx)(k.ZL,{children:(0,a.jsxs)(k.UC,{"data-slot":"select-content",className:(0,v.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[(0,a.jsx)(L,{}),(0,a.jsx)(k.LM,{className:(0,v.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(O,{})]})})}function A(e){let{className:t,children:s,...n}=e;return(0,a.jsxs)(k.q7,{"data-slot":"select-item",className:(0,v.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(k.VF,{children:(0,a.jsx)(y.A,{className:"size-4"})})}),(0,a.jsx)(k.p4,{children:s})]})}function L(e){let{className:t,...s}=e;return(0,a.jsx)(k.PP,{"data-slot":"select-scroll-up-button",className:(0,v.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(C.A,{className:"size-4"})})}function O(e){let{className:t,...s}=e;return(0,a.jsx)(k.wn,{"data-slot":"select-scroll-down-button",className:(0,v.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(N.A,{className:"size-4"})})}var T=s(71365);function _(){let e=(0,u.A)(),t=(0,n.useRef)(null),[s,m]=(0,n.useState)([]),[p,h]=(0,n.useState)([]),[g,j]=(0,n.useState)(T.I),k=()=>{t.current&&(t.current.value="")},N=(0,n.useCallback)(()=>{if(!t.current||!e)return;let s=t.current.value;if(0===s.length)return void c.oR.warning("请输入指令以发送");e.send({type:"command",data:s}),h(e=>[...e,s]),k()},[e]),y=s=>{if(!t.current||!e)return;let a=t.current;document.activeElement===a&&"Enter"===s.key&&(N(),m([]))},C=(0,n.useCallback)(()=>{var s;if(!t.current||!e)return;let a=t.current;e.send({type:"autocomplete",data:(0,v.qJ)(a.value,null!=(s=a.selectionStart)?s:0)})},[e]);return(0,n.useEffect)(()=>{null==e||e.onMessage((e,t)=>{"autocomplete"===e&&m(t)})},[e]),(0,a.jsxs)(d.C,{title:"后台",icon:(0,a.jsx)(r.A,{}),className:"grid grid-cols-5 gap-3",children:[(0,a.jsxs)("div",{className:"h-[500px] max-h-[500px] col-span-4 flex flex-col gap-3",children:[(0,a.jsx)(x.e,{client:e,level:g,className:"flex-1"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(E,{defaultValue:T.I,onValueChange:e=>j(e),children:[(0,a.jsx)(z,{className:"w-24 font-[Consolas]",title:"日志等级",children:(0,a.jsx)(S,{})}),(0,a.jsxs)(R,{className:"font-[Consolas]",children:[(0,a.jsx)(A,{value:"INFO",children:"INFO"}),(0,a.jsx)(A,{value:"WARN",children:"WARN"}),(0,a.jsx)(A,{value:"ERROR",children:"ERROR"})]})]}),(0,a.jsx)(b,{className:"flex-1 w-full rounded-sm font-[Consolas]",placeholder:"发送消息 / 指令...",autoFocus:!0,itemList:s,onKeyDown:e=>y(e),onInput:()=>C(),ref:t}),(0,a.jsx)(f.$,{variant:"ghost",size:"icon",className:"cursor-pointer",title:"清空",onClick:()=>k(),children:(0,a.jsx)(l.A,{})}),(0,a.jsx)(f.$,{size:"icon",className:"cursor-pointer",title:"发送",onClick:()=>N(),children:(0,a.jsx)(o.A,{})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"px-3 flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-md font-semibold",children:"历史记录"}),(0,a.jsx)(f.$,{variant:"ghost",size:"icon",className:"cursor-pointer",onClick:()=>h([]),children:(0,a.jsx)(i.A,{})})]}),(0,a.jsx)(w.Zp,{className:"flex-1 rounded-sm p-1 flex flex-col gap-0 overflow-y-auto",children:p.map((e,s)=>(0,a.jsx)(f.$,{variant:"ghost",size:"sm",className:"block px-2 py-0 rounded-xs text-left font-[Consolas] text-nowrap text-ellipsis overflow-hidden cursor-pointer",onClick:()=>{t.current&&(t.current.value=e)},onDoubleClick:()=>N(),children:e},s))})]})]})}},88482:(e,t,s)=>{"use strict";s.d(t,{BT:()=>i,Wu:()=>c,ZB:()=>o,Zp:()=>r,aR:()=>l,wL:()=>d});var a=s(95155);s(12115);var n=s(51907);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center px-6 [.border-t]:pt-6",t),...s})}}},e=>{var t=t=>e(e.s=t);e.O(0,[455,370,702,671,464,387,527,32,196,441,684,358],()=>t(59505)),_N_E=e.O()}]);