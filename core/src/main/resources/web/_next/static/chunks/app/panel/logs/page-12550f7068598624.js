(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{24232:(e,t,a)=>{"use strict";a.d(t,{C:()=>g});var l=a(95155);a(12115);var n=a(13052),s=a(51907);function r(e){let{...t}=e;return(0,l.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...t})}function o(e){let{className:t,...a}=e;return(0,l.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,s.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",t),...a})}function i(e){let{className:t,...a}=e;return(0,l.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,s.cn)("inline-flex items-center gap-1.5",t),...a})}function c(e){let{className:t,...a}=e;return(0,l.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,s.cn)("text-foreground font-normal",t),...a})}function d(e){let{children:t,className:a,...r}=e;return(0,l.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,s.cn)("[&>svg]:size-3.5",a),...r,children:null!=t?t:(0,l.jsx)(n.A,{})})}var x=a(76037),u=a(71196);function g(e){let{children:t,title:a,subTitle:n,icon:g,className:h}=e;return(0,l.jsxs)("div",{className:"px-16 flex-1 flex flex-col gap-6",children:[(0,l.jsxs)("div",{className:"py-10 flex flex-col gap-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(u.SidebarTrigger,{className:"cursor-pointer"}),(0,l.jsx)(x.Separator,{orientation:"vertical"}),(0,l.jsx)(r,{children:(0,l.jsxs)(o,{children:[(0,l.jsx)(i,{children:"OPanel"}),(0,l.jsx)(d,{}),n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i,{children:a}),(0,l.jsx)(d,{})]}),(0,l.jsx)(i,{children:(0,l.jsx)(c,{children:null!=n?n:a})})]})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-5",children:[g,(0,l.jsx)("h1",{className:"text-3xl font-bold",children:null!=n?n:a})]})]}),(0,l.jsx)("div",{className:(0,s.cn)(h,"pb-16"),children:t})]})}},31886:(e,t,a)=>{"use strict";a.d(t,{$M:()=>i,nl:()=>d,ow:()=>c,qV:()=>o,y0:()=>s,yq:()=>r});var l=a(23464),n=a(16453);let s="",r=globalThis.window?"ws://".concat(window.location.host):"ws://localhost:3000";async function o(e){return(await l.A.request({method:"get",url:s+e,headers:{"X-Credential-Token":(0,n.getCookie)("token")}})).data}async function i(e,t){let a=t?JSON.stringify(t):"";return(await l.A.request({method:"post",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain"},data:a})).data}async function c(e,t){let a=t?JSON.stringify(t):"";return(await l.A.request({method:"post",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,n.getCookie)("token")},data:a})).data}async function d(e,t){let a=t?JSON.stringify(t):"";return(await l.A.request({method:"delete",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,n.getCookie)("token")},data:a})).data}},49982:(e,t,a)=>{Promise.resolve().then(a.bind(a,54442))},54442:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var l=a(95155),n=a(56671),s=a(23323),r=a(62525),o=a(24232),i=a(12115),c=a(52278),d=a(42355),x=a(13052),u=a(12767),g=a(36268),h=a(11032),m=a(88524),j=a(51907),f=a(97168);function p(e){var t;let{columns:a,data:n,pagination:s,className:r}=e,[o,p]=(0,i.useState)({pageIndex:0,pageSize:10}),b=(0,g.N4)({columns:a,data:n,getCoreRowModel:(0,h.HT)(),getPaginationRowModel:s?(0,h.kW)():void 0,onPaginationChange:p,state:{pagination:o}});return(0,l.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,l.jsx)("div",{className:(0,j.cn)(r,"border rounded-md"),children:(0,l.jsxs)(m.XI,{children:[(0,l.jsx)(m.A0,{children:b.getHeaderGroups().map(e=>(0,l.jsx)(m.Hj,{children:e.headers.map(e=>(0,l.jsx)(m.nd,{children:e.isPlaceholder?null:(0,g.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,l.jsx)(m.BF,{children:(null==(t=b.getRowModel().rows)?void 0:t.length)?b.getRowModel().rows.map(e=>(0,l.jsx)(m.Hj,{children:e.getVisibleCells().map(e=>(0,l.jsx)(m.nA,{children:(0,g.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,l.jsx)(m.Hj,{children:(0,l.jsx)(m.nA,{colSpan:a.length,className:"h-24 text-center",children:"No results."})})})]})}),s&&(0,l.jsxs)("div",{className:"flex gap-3 items-center [&>button]:cursor-pointer",children:[(0,l.jsx)(f.$,{variant:"outline",size:"icon",title:"跳转至第一页",onClick:()=>b.firstPage(),disabled:!b.getCanPreviousPage(),children:(0,l.jsx)(c.A,{})}),(0,l.jsxs)(f.$,{variant:"outline",onClick:()=>b.previousPage(),disabled:!b.getCanPreviousPage(),children:[(0,l.jsx)(d.A,{}),"上一页"]}),(0,l.jsxs)(f.$,{variant:"outline",onClick:()=>b.nextPage(),disabled:!b.getCanNextPage(),children:["下一页",(0,l.jsx)(x.A,{})]}),(0,l.jsx)(f.$,{variant:"outline",size:"icon",title:"跳转至最后一页",onClick:()=>b.lastPage(),disabled:!b.getCanNextPage(),children:(0,l.jsx)(u.A,{})}),(0,l.jsxs)("span",{className:"text-muted-foreground text-sm",children:["第 ",o.pageIndex+1," 页 / 共 ",b.getPageCount()," 页"]})]})]})}var b=a(6874),v=a.n(b),N=a(42757),w=a.n(N),y=a(91788),C=a(31886);let k=[{accessorKey:"name",header:()=>(0,l.jsx)("span",{className:"pl-3",children:"日志"}),cell:e=>{var t;let{row:a}=e,n=null!=(t=a.getValue("name"))?t:"";return(0,l.jsx)(f.$,{variant:"link",size:"sm",className:"h-4 font-semibold",asChild:!0,children:(0,l.jsx)(v(),{href:"/panel/logs/view?log=".concat(n),children:n})})}},{accessorKey:"type",header:"类型",cell:e=>{let{row:t}=e;return(0,l.jsx)("span",{className:"text-muted-foreground",children:t.getValue("type")})}},{header:" ",cell:e=>{let{row:t}=e;return(0,l.jsxs)("div",{className:"flex justify-end [&>*]:h-4 [&>*]:cursor-pointer [&>*]:hover:!bg-transparent",children:[(0,l.jsx)(f.$,{variant:"ghost",size:"icon",title:"下载日志",onClick:async()=>{var e;let a=null!=(e=t.getValue("name"))?e:"",l=a.endsWith(".log.gz")?a.replace(".log.gz",".log"):a;try{let e=await (0,C.qV)("/api/logs/".concat(a));w()(e.log,l,"text/plain")}catch(e){n.oR.error("下载失败",{description:"无法下载日志".concat(l)})}},children:(0,l.jsx)(y.A,{})}),(0,l.jsx)(f.$,{variant:"ghost",size:"icon",title:"删除日志",onClick:async()=>{var e;let a=null!=(e=t.getValue("name"))?e:"";try{await (0,C.nl)("/api/logs/".concat(a)),n.oR.success("删除成功"),window.location.reload()}catch(e){n.oR.error("删除失败")}},children:(0,l.jsx)(r.A,{})})]})}}];var A=a(17649);function P(e){let{...t}=e;return(0,l.jsx)(A.bL,{"data-slot":"alert-dialog",...t})}function z(e){let{...t}=e;return(0,l.jsx)(A.l9,{"data-slot":"alert-dialog-trigger",...t})}function R(e){let{...t}=e;return(0,l.jsx)(A.ZL,{"data-slot":"alert-dialog-portal",...t})}function S(e){let{className:t,...a}=e;return(0,l.jsx)(A.hJ,{"data-slot":"alert-dialog-overlay",className:(0,j.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function T(e){let{className:t,...a}=e;return(0,l.jsxs)(R,{children:[(0,l.jsx)(S,{}),(0,l.jsx)(A.UC,{"data-slot":"alert-dialog-content",className:(0,j.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function V(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,j.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function $(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,j.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function q(e){let{className:t,...a}=e;return(0,l.jsx)(A.hE,{"data-slot":"alert-dialog-title",className:(0,j.cn)("text-lg font-semibold",t),...a})}function _(e){let{className:t,...a}=e;return(0,l.jsx)(A.VY,{"data-slot":"alert-dialog-description",className:(0,j.cn)("text-muted-foreground text-sm",t),...a})}function O(e){let{className:t,...a}=e;return(0,l.jsx)(A.rc,{className:(0,j.cn)((0,f.r)(),t),...a})}function H(e){let{className:t,...a}=e;return(0,l.jsx)(A.ZD,{className:(0,j.cn)((0,f.r)({variant:"outline"}),t),...a})}function B(){let[e,t]=(0,i.useState)([]),a=async()=>{try{let e=await (0,C.qV)("/api/logs");t(e.logs)}catch(e){n.oR.error("无法获取日志列表")}},c=async()=>{try{await (0,C.nl)("/api/logs"),n.oR.success("已清空除当前日志外的所有日志"),window.location.reload()}catch(e){n.oR.error("清空日志失败")}};return(0,i.useEffect)(()=>{a()},[]),(0,l.jsxs)(o.C,{title:"日志",icon:(0,l.jsx)(s.A,{}),className:"flex flex-col gap-5",children:[(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsxs)(P,{children:[(0,l.jsx)(z,{asChild:!0,children:(0,l.jsxs)(f.$,{variant:"destructive",className:"cursor-pointer",children:[(0,l.jsx)(r.A,{}),"清空日志"]})}),(0,l.jsxs)(T,{children:[(0,l.jsxs)(V,{children:[(0,l.jsx)(q,{children:"确定要清空所有日志文件吗？"}),(0,l.jsx)(_,{children:"此操作不会清除当前的服务器日志，但被清空的日志文件将不可恢复。"})]}),(0,l.jsxs)($,{children:[(0,l.jsx)(H,{children:"取消"}),(0,l.jsx)(O,{onClick:()=>c(),children:"确定"})]})]})]})}),(0,l.jsx)(p,{columns:k,data:e.map(e=>({name:e,type:".gz"===e.substring(e.lastIndexOf("."))?"gzip":"log"})),pagination:!0,className:"max-h-[500px] overflow-y-auto"})]})}},88524:(e,t,a)=>{"use strict";a.d(t,{A0:()=>r,BF:()=>o,Hj:()=>i,XI:()=>s,nA:()=>d,nd:()=>c});var l=a(95155);a(12115);var n=a(51907);function s(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,l.jsx)("table",{"data-slot":"table",className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})}function r(e){let{className:t,...a}=e;return(0,l.jsx)("thead",{"data-slot":"table-header",className:(0,n.cn)("[&_tr]:border-b",t),...a})}function o(e){let{className:t,...a}=e;return(0,l.jsx)("tbody",{"data-slot":"table-body",className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})}function i(e){let{className:t,...a}=e;return(0,l.jsx)("tr",{"data-slot":"table-row",className:(0,n.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function c(e){let{className:t,...a}=e;return(0,l.jsx)("th",{"data-slot":"table-head",className:(0,n.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function d(e){let{className:t,...a}=e;return(0,l.jsx)("td",{"data-slot":"table-cell",className:(0,n.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}}},e=>{var t=t=>e(e.s=t);e.O(0,[455,257,702,671,464,874,203,196,441,684,358],()=>t(49982)),_N_E=e.O()}]);