(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{14657:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(95155),a=r(12115),s=r(28916),o=r(51907);function l(e){let t,{time:r,level:a,thread:o,source:l,line:i,simple:c}=e,d=l.split("."),u=d[d.length-1];switch(a){case"INFO":t="text-green-700 dark:text-green-500";break;case"WARN":case"DEBUG":case"TRACE":t="text-yellow-700 dark:text-yellow-600";break;case"ERROR":case"FATAL":t="text-red-700 dark:text-red-400"}return(0,n.jsxs)("p",{className:"text-xs text-nowrap font-[Consolas] space-x-1",children:[(0,n.jsx)("span",{className:"text-blue-500 dark:text-blue-400",children:"[".concat((0,s.GP)(new Date(r),"HH:mm:ss"),"]")}),!c&&(0,n.jsx)("span",{className:t,children:"[".concat(o,"/").concat(a,"]")}),!c&&(0,n.jsx)("span",{className:"text-emerald-600 dark:text-emerald-500",children:"(".concat(u,")")}),(0,n.jsx)("span",{children:i})]})}function i(e){let{client:t,simple:r,className:s}=e,i=(0,a.useRef)(null),[c,d]=(0,a.useState)([]),u=e=>{d(t=>[...t,e])},f=()=>{i.current&&(i.current.innerHTML="")};return(0,a.useEffect)(()=>{if(!i.current)return;let e=i.current;e.scrollTo({top:e.scrollHeight})},[c]),(0,a.useEffect)(()=>{if(t)return t.onMessage((e,t)=>{switch(e){case"init":for(let e of t)u(e);break;case"log":u(t)}}),()=>f()},[t]),(0,n.jsx)("div",{className:(0,o.cn)(s,"border rounded-sm bg-background overflow-auto p-2"),ref:i,children:c.map((e,t)=>(0,a.createElement)(l,{...e,simple:r,key:t}))})}},15424:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var n=r(95155),a=r(12115),s=r(62978),o=r(54416);let l=(0,r(19946).A)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var i=r(62525),c=r(24232),d=r(55424),u=r(14657),f=r(97168),x=r(45772),h=r.n(x);let p=a.createContext(void 0);var m=r(89852),g=r(51907);function v(e){let{name:t,selected:r,index:s}=e,{value:o,setSelected:l,complete:i}=(0,a.useContext)(p);return(0,n.jsxs)(f.$,{variant:"ghost",className:"block h-fit p-1 rounded-xs text-sm text-left font-[Consolas] cursor-pointer hover:bg-transparent active:bg-muted data-[selected=true]:!bg-muted","data-selected":r,onClick:()=>l(s),onDoubleClick:()=>i(),children:[(0,n.jsx)("span",{className:"font-bold",children:o}),(0,n.jsx)("span",{children:t.replace(o,"")})]})}function b(e){var t,r;let{itemList:s,onInput:o,ref:l,...i}=e,[c,d]=(0,a.useState)(""),[u,f]=(0,a.useState)(0),[x,b]=(0,a.useState)(0),[w,k]=(0,a.useState)(s),[j,y]=(0,a.useState)(null),N=0===c.length||0===w.length,C=async()=>{var e;if(!l.current)return;let t=await (0,g.LJ)(k),r=await (0,g.LJ)(y),n=await (0,g.LJ)(d);if(null===r)return;let a=t[r].replace((0,g.eg)(n,null!=(e=l.current.selectionStart)?e:0),"");l.current.value=n+a,d(n+a)};return(0,a.useEffect)(()=>{k(s)},[s]),(0,a.useEffect)(()=>{var e;if(!l.current)return;let t=l.current,r=t.getBoundingClientRect();f(r.top+r.height+2),b(t.offsetLeft+h()(t,null!=(e=t.selectionStart)?e:0).left);let n=[],a=t.selectionStart;for(let e of s)e.startsWith((0,g.eg)(c,null!=a?a:0))&&n.push(e);k(n),y(n.length>0?0:null)},[c,s,l]),(0,a.useEffect)(()=>{document.body.addEventListener("keydown",async e=>{let t=await (0,g.LJ)(k),r=await (0,g.LJ)(y);switch(e.key){case"Tab":if(null===r||!l.current)return;e.preventDefault(),C();break;case"ArrowUp":if(null===r)return;e.preventDefault(),y(r>0?r-1:t.length-1);break;case"ArrowDown":if(null===r)return;e.preventDefault(),y(r<t.length-1?r+1:0)}})},[]),(0,n.jsxs)(p.Provider,{value:{value:(0,g.eg)(c,null!=(r=null==(t=l.current)?void 0:t.selectionStart)?r:0),setSelected:y,complete:C},children:[(0,n.jsx)(m.p,{...i,onInput:e=>{d(e.target.value),o&&o(e)},ref:l}),(0,n.jsx)("div",{className:(0,g.cn)("absolute flex flex-col bg-popover min-w-40 w-fit max-h-32 p-1 border rounded-sm overflow-y-auto",N?"hidden":""),style:{top:u,left:x},children:w.map((e,t)=>(0,n.jsx)(v,{name:e,selected:j===t,index:t},t))})]})}var w=r(88482),k=r(56671);function j(){let e=(0,d.A)(),t=(0,a.useRef)(null),[r,x]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),m=()=>{t.current&&(t.current.value="")},v=(0,a.useCallback)(()=>{if(!t.current||!e)return;let r=t.current.value;if(0===r.length)return void k.oR.warning("请输入指令以发送");e.send({type:"command",data:r}),p(e=>[...e,r]),m()},[e]),j=r=>{if(!t.current||!e)return;let n=t.current;document.activeElement===n&&"Enter"===r.key&&(v(),x([]))},y=(0,a.useCallback)(()=>{var r;if(!t.current||!e)return;let n=t.current;e.send({type:"autocomplete",data:(0,g.qJ)(n.value,null!=(r=n.selectionStart)?r:0)})},[e]);return(0,a.useEffect)(()=>{null==e||e.onMessage((e,t)=>{"autocomplete"===e&&x(t)})},[e]),(0,n.jsxs)(c.C,{title:"后台",icon:(0,n.jsx)(s.A,{}),className:"grid grid-cols-5 gap-3",children:[(0,n.jsxs)("div",{className:"h-[500px] max-h-[500px] col-span-4 flex flex-col gap-3",children:[(0,n.jsx)(u.e,{client:e,className:"flex-1"}),(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(b,{className:"flex-1 w-full rounded-sm font-[Consolas]",placeholder:"发送消息 / 指令...",autoFocus:!0,itemList:r,onKeyDown:e=>j(e),onInput:()=>y(),ref:t}),(0,n.jsx)(f.$,{variant:"ghost",size:"icon",className:"cursor-pointer",title:"清空",onClick:()=>m(),children:(0,n.jsx)(o.A,{})}),(0,n.jsx)(f.$,{size:"icon",className:"cursor-pointer",title:"发送",onClick:()=>v(),children:(0,n.jsx)(l,{})})]})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"px-3 flex justify-between items-center",children:[(0,n.jsx)("h2",{className:"text-md font-semibold",children:"历史记录"}),(0,n.jsx)(f.$,{variant:"ghost",size:"icon",className:"cursor-pointer",onClick:()=>p([]),children:(0,n.jsx)(i.A,{})})]}),(0,n.jsx)(w.Zp,{className:"flex-1 rounded-sm p-1 flex flex-col gap-0 overflow-y-auto",children:h.map((e,r)=>(0,n.jsx)(f.$,{variant:"ghost",size:"sm",className:"block px-2 py-0 rounded-xs text-left font-[Consolas] text-nowrap text-ellipsis overflow-hidden cursor-pointer",onClick:()=>{t.current&&(t.current.value=e)},onDoubleClick:()=>v(),children:e},r))})]})]})}},24232:(e,t,r)=>{"use strict";r.d(t,{C:()=>x});var n=r(95155);r(12115);var a=r(13052),s=r(51907);function o(e){let{...t}=e;return(0,n.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...t})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,s.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,s.cn)("inline-flex items-center gap-1.5",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,s.cn)("text-foreground font-normal",t),...r})}function d(e){let{children:t,className:r,...o}=e;return(0,n.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,s.cn)("[&>svg]:size-3.5",r),...o,children:null!=t?t:(0,n.jsx)(a.A,{})})}var u=r(76037),f=r(71196);function x(e){let{children:t,title:r,subTitle:a,icon:x,className:h}=e;return(0,n.jsxs)("div",{className:"px-16 flex-1 flex flex-col gap-6",children:[(0,n.jsxs)("div",{className:"py-10 flex flex-col gap-8",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(f.SidebarTrigger,{className:"cursor-pointer"}),(0,n.jsx)(u.Separator,{orientation:"vertical"}),(0,n.jsx)(o,{children:(0,n.jsxs)(l,{children:[(0,n.jsx)(i,{children:"OPanel"}),(0,n.jsx)(d,{}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i,{children:r}),(0,n.jsx)(d,{})]}),(0,n.jsx)(i,{children:(0,n.jsx)(c,{children:null!=a?a:r})})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-5",children:[x,(0,n.jsx)("h1",{className:"text-3xl font-bold",children:null!=a?a:r})]})]}),(0,n.jsx)("div",{className:(0,s.cn)(h,"pb-16"),children:t})]})}},31886:(e,t,r)=>{"use strict";r.d(t,{$M:()=>i,nl:()=>d,ow:()=>c,qV:()=>l,y0:()=>s,yq:()=>o});var n=r(23464),a=r(16453);let s="",o=globalThis.window?"ws://".concat(window.location.host):"ws://localhost:3000";async function l(e){return(await n.A.request({method:"get",url:s+e,headers:{"X-Credential-Token":(0,a.getCookie)("token")}})).data}async function i(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"post",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain"},data:r})).data}async function c(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"post",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,a.getCookie)("token")},data:r})).data}async function d(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"delete",maxBodyLength:1/0,url:s+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,a.getCookie)("token")},data:r})).data}},45772:e=>{!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],r="undefined"!=typeof window,n=r&&null!=window.mozInnerScreenX;function a(e,a,s){if(!r)throw Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var o=s&&s.debug||!1;if(o){var l=document.querySelector("#input-textarea-caret-position-mirror-div");l&&l.parentNode.removeChild(l)}var i=document.createElement("div");i.id="input-textarea-caret-position-mirror-div",document.body.appendChild(i);var c=i.style,d=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,u="INPUT"===e.nodeName;c.whiteSpace="pre-wrap",u||(c.wordWrap="break-word"),c.position="absolute",o||(c.visibility="hidden"),t.forEach(function(e){u&&"lineHeight"===e?c.lineHeight=d.height:c[e]=d[e]}),n?e.scrollHeight>parseInt(d.height)&&(c.overflowY="scroll"):c.overflow="hidden",i.textContent=e.value.substring(0,a),u&&(i.textContent=i.textContent.replace(/\s/g,"\xa0"));var f=document.createElement("span");f.textContent=e.value.substring(a)||".",i.appendChild(f);var x={top:f.offsetTop+parseInt(d.borderTopWidth),left:f.offsetLeft+parseInt(d.borderLeftWidth),height:parseInt(d.lineHeight)};return o?f.style.backgroundColor="#aaa":document.body.removeChild(i),x}void 0!==e.exports?e.exports=a:r&&(window.getCaretCoordinates=a)}()},55424:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(12115),a=r(56671),s=r(31886);class o{init(){var e,t,r;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected.")}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e)}),null==(r=this.socket)||r.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:r,data:n}=JSON.parse(t.data);if(console.log("[Terminal] "+n.line),"init"===r&&!(n instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===r)throw a.oR.error("Packet Error",{description:n}),Error("Packet error: "+n);e(r,n)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){this.socket=null,this.socket=new WebSocket(s.yq+"/terminal"),this.init()}}function l(){let[e,t]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=new o;return t(e),()=>e.close()},[]),e}},59505:(e,t,r)=>{Promise.resolve().then(r.bind(r,15424))},62525:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(19946).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>i,Wu:()=>c,ZB:()=>l,Zp:()=>s,aR:()=>o,wL:()=>d});var n=r(95155);r(12115);var a=r(51907);function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",t),...r})}}},e=>{var t=t=>e(e.s=t);e.O(0,[455,257,702,671,464,527,196,441,684,358],()=>t(59505)),_N_E=e.O()}]);