(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{14133:(e,t,r)=>{Promise.resolve().then(r.bind(r,38456))},14657:(e,t,r)=>{"use strict";r.d(t,{e:()=>c});var n=r(95155),s=r(12115),a=r(28916),l=r(53999),o=r(71365);function i(e){let t,{time:r,level:s,thread:o,source:i,line:c,simple:d,visible:u}=e,x=i.split("."),h=x[x.length-1];switch(s){case"INFO":t="text-green-700 dark:text-green-500";break;case"WARN":t="text-yellow-700 dark:text-yellow-600";break;case"ERROR":t="text-red-700 dark:text-red-400"}return(0,n.jsxs)("p",{className:(0,l.cn)("text-xs text-nowrap font-[Consolas] space-x-1",u?"":"hidden"),children:[(0,n.jsx)("span",{className:"text-blue-500 dark:text-blue-400",children:"[".concat((0,a.GP)(new Date(r),"HH:mm:ss"),"]")}),!d&&(0,n.jsx)("span",{className:t,children:"[".concat(o,"/").concat(s,"]")}),!d&&(0,n.jsx)("span",{className:"text-emerald-600 dark:text-emerald-500",children:"(".concat(h,")")}),(0,n.jsx)("span",{children:c})]})}function c(e){let{client:t,simple:r,level:a,className:c}=e,d=(0,s.useRef)(null),[u,x]=(0,s.useState)([]),h=e=>{x(t=>[...t,e])},m=()=>{d.current&&(d.current.innerHTML="")};return(0,s.useEffect)(()=>{if(!d.current)return;let e=d.current;e.scrollTo({top:e.scrollHeight})},[u]),(0,s.useEffect)(()=>{if(t)return t.onMessage((e,t)=>{switch(e){case"init":for(let e of t)h(e);break;case"log":h(t)}}),()=>m()},[t]),(0,n.jsx)("div",{className:(0,l.cn)(c,"border rounded-sm bg-background overflow-auto p-2"),ref:d,children:u.map((e,t)=>(0,s.createElement)(i,{...e,simple:r,visible:(0,o.k)(e.level)>=(0,o.k)(null!=a?a:o.I),key:t}))})}},16559:(e,t,r)=>{"use strict";r.d(t,{$v:()=>f,EO:()=>u,Lt:()=>o,Rx:()=>p,Zr:()=>j,ck:()=>h,r7:()=>m,tv:()=>i,wd:()=>x});var n=r(95155);r(12115);var s=r(17649),a=r(53999),l=r(97168);function o(e){let{...t}=e;return(0,n.jsx)(s.bL,{"data-slot":"alert-dialog",...t})}function i(e){let{...t}=e;return(0,n.jsx)(s.l9,{"data-slot":"alert-dialog-trigger",...t})}function c(e){let{...t}=e;return(0,n.jsx)(s.ZL,{"data-slot":"alert-dialog-portal",...t})}function d(e){let{className:t,...r}=e;return(0,n.jsx)(s.hJ,{"data-slot":"alert-dialog-overlay",className:(0,a.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function u(e){let{className:t,...r}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(d,{}),(0,n.jsx)(s.UC,{"data-slot":"alert-dialog-content",className:(0,a.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r})]})}function x(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,a.cn)("flex flex-col gap-2 text-center sm:text-left",t),...r})}function h(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,a.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function m(e){let{className:t,...r}=e;return(0,n.jsx)(s.hE,{"data-slot":"alert-dialog-title",className:(0,a.cn)("text-lg font-semibold",t),...r})}function f(e){let{className:t,...r}=e;return(0,n.jsx)(s.VY,{"data-slot":"alert-dialog-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function p(e){let{className:t,...r}=e;return(0,n.jsx)(s.rc,{className:(0,a.cn)((0,l.r)(),t),...r})}function j(e){let{className:t,...r}=e;return(0,n.jsx)(s.ZD,{className:(0,a.cn)((0,l.r)({variant:"outline"}),t),...r})}},24232:(e,t,r)=>{"use strict";r.d(t,{C:()=>h});var n=r(95155);r(12115);var s=r(13052),a=r(53999);function l(e){let{...t}=e;return(0,n.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...t})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,a.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,a.cn)("inline-flex items-center gap-1.5",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,a.cn)("text-foreground font-normal",t),...r})}function d(e){let{children:t,className:r,...l}=e;return(0,n.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,a.cn)("[&>svg]:size-3.5",r),...l,children:null!=t?t:(0,n.jsx)(s.A,{})})}var u=r(76037),x=r(20193);function h(e){let{children:t,title:r,subTitle:s,icon:h,className:m}=e;return(0,n.jsxs)("div",{className:"px-16 flex-1 flex flex-col gap-6",children:[(0,n.jsxs)("div",{className:"pt-10 pb-5 flex flex-col gap-8",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(x.SidebarTrigger,{className:"cursor-pointer"}),(0,n.jsx)(u.Separator,{orientation:"vertical"}),(0,n.jsx)(l,{children:(0,n.jsxs)(o,{children:[(0,n.jsx)(i,{children:"OPanel"}),(0,n.jsx)(d,{}),s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i,{children:r}),(0,n.jsx)(d,{})]}),(0,n.jsx)(i,{children:(0,n.jsx)(c,{children:null!=s?s:r})})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-5",children:[h,(0,n.jsx)("h1",{className:"text-3xl font-bold",children:null!=s?s:r})]})]}),(0,n.jsx)("div",{className:(0,a.cn)(m,"pb-16"),children:t})]})}},31886:(e,t,r)=>{"use strict";r.d(t,{$M:()=>u,Hh:()=>i,nF:()=>o,nl:()=>h,ow:()=>x,qV:()=>d,v_:()=>c,y0:()=>a,yq:()=>l});var n=r(23464),s=r(16453);let a="",l=globalThis.window?"ws://".concat(window.location.host):"ws://localhost:3000",o="https://crafatar.com/avatars/",i="https://crafatar.com/skins/",c="https://crafatar.com/capes/";async function d(e){return(await n.A.request({method:"get",url:a+e,headers:{"X-Credential-Token":(0,s.getCookie)("token")}})).data}async function u(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"post",maxBodyLength:1/0,url:a+e,headers:{"Content-Type":"text/plain"},data:r})).data}async function x(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"post",maxBodyLength:1/0,url:a+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,s.getCookie)("token")},data:r})).data}async function h(e,t){let r=t?JSON.stringify(t):"";return(await n.A.request({method:"delete",maxBodyLength:1/0,url:a+e,headers:{"Content-Type":"text/plain","X-Credential-Token":(0,s.getCookie)("token")},data:r})).data}},38456:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ex});var n=r(95155),s=r(12115),a=r(98611),l=r(56671),o=r(24232);let i=function(){let e=s.createContext(void 0);return e.displayName="APIContext",e}(),c=s.createContext(void 0);c.displayName="APIContext";var d=r(31886),u=r(381),x=r(32568),h=r(27265),m=r(88482),f=r(53999);let p=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],j=["k","l","m","n","o"],v="|i!:;.";function g(e){return" "===e?" ":v.includes(e)?(0,f.gI)(v.split("")):(0,f.gI)("+/\\=023456789ABCDEFGHJKLMNOPQRSTUVWXYZabcdeghjmnopqrsuvwxyz\xa2\xa3\xa5\xb1\xb5\xc0\xc1\xc2\xc3\xc4\xc5\xc7\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xeb".split(""))}var b=r(92391),N=r.n(b);function k(e){let{maxLines:t,children:r,className:a}=e,l=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(l.current)for(let e of(l.current.innerHTML="",l.current.appendChild(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.replaceAll("\xc2",""),n=document.createElement("span");n.className="cc-root";let s=n,a=1;for(let e=0;e<r.length;e++){let l=r[e];if("\n"===l&&a<t){s.appendChild(document.createElement("br")),a++;continue}if("\xa7"===l){let t=r[e+1];if("r"===t){s=n,e++;continue}let a=p.includes(t),l=j.includes(t);if(!a&&!l)continue;a&&(s=n);let o=document.createElement("span");o.className="cc-".concat(t),s.appendChild(o),s=o,e++}else s.innerHTML+=l}return n}(r,t)),l.current.getElementsByClassName("cc-k")))e instanceof HTMLSpanElement&&function(e){let t=e.innerText,r=()=>{e.innerText=Array.from(t).map(g).join(""),requestAnimationFrame(r)};requestAnimationFrame(r)}(e)},[r,t]),(0,n.jsx)("div",{className:(0,f.cn)(a,N().className),ref:l})}var y=r(88145),w=r(97168),C=r(16559);let A={src:"/_next/static/media/pack.3fda983d.png"};var E=r(91364),_=r(51362),L=r(41085);function R(e){let{children:t,asChild:r}=e,[a,o]=(0,s.useState)(""),{theme:i}=(0,_.D)(),c=(0,s.useRef)(null),u=async()=>{try{let e=await (0,d.qV)("/api/control/properties");o(e.properties)}catch(e){l.oR.error("无法获取server.properties")}},x=async()=>{if(c.current&&c.current.getValue()!==a)try{await (0,d.ow)("/api/control/properties",c.current.getValue()),l.oR.success("保存成功",{description:"重启服务器以使改动生效"})}catch(e){l.oR.error("无法保存server.properties")}};return(0,n.jsxs)(L.cj,{onOpenChange:e=>e&&u(),children:[(0,n.jsx)(L.CG,{asChild:r,children:t}),(0,n.jsxs)(L.h,{children:[(0,n.jsxs)(L.Fm,{children:[(0,n.jsx)(L.qp,{children:"编辑 server.properties"}),(0,n.jsxs)(L.Qs,{children:["在此编辑服务器配置文件，你也可以直接编辑服务器目录下的",(0,n.jsx)("code",{children:"server.properties"}),"文件。"]})]}),(0,n.jsx)("div",{className:"flex flex-col h-full",children:(0,n.jsx)(E.KE,{defaultLanguage:"ini",defaultValue:a,theme:"dark"===i?"vs-dark":"vs",options:{minimap:{enabled:!1},automaticLayout:!0},onMount:e=>c.current=e})}),(0,n.jsxs)(L.XW,{children:[(0,n.jsx)("span",{className:"text-sm text-muted-foreground",children:"需重启服务器以使改动生效。"}),(0,n.jsx)(L.kN,{asChild:!0,children:(0,n.jsx)(w.$,{className:"cursor-pointer",onClick:()=>x(),children:"保存设置"})})]})]})]})}function T(e){let{className:t}=e,r=(0,s.useContext)(i);return(0,n.jsxs)(m.Zp,{className:(0,f.cn)(t,"flex flex-row rounded-md"),children:[(0,n.jsx)("img",{className:"aspect-square h-full rounded-xs",src:r&&r.favicon?d.y0+r.favicon:A.src,alt:"favicon"}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex gap-4 [&>*]:space-x-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold",children:"版本:"}),(0,n.jsx)("span",{children:null==r?void 0:r.version})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold",children:"端口:"}),(0,n.jsx)("span",{className:"text-emerald-500 font-[Consolas]",children:r?r.port:""})]})]}),(0,n.jsx)("div",{className:"h-fit text-sm",children:r&&(0,n.jsx)(k,{maxLines:2,children:"\xa77"+atob(r.motd)})})]}),(0,n.jsxs)("div",{className:"flex flex-col justify-between",children:[(0,n.jsxs)(y.E,{className:"self-end",variant:"outline",children:[(0,n.jsx)("div",{className:(0,f.cn)("w-2 h-2 rounded-full",r?"bg-green-600":"bg-red-700")}),r?"正在运行":"未运行"]}),(0,n.jsxs)("div",{className:"space-x-1 self-end [&>*]:cursor-pointer",children:[(0,n.jsx)(R,{asChild:!0,children:(0,n.jsx)(w.$,{variant:"ghost",size:"icon",title:"编辑server.properties",children:(0,n.jsx)(u.A,{})})}),(0,n.jsx)(w.$,{variant:"ghost",size:"icon",title:"重载服务器",onClick:()=>l.oR.promise((0,d.ow)("/api/control/reload"),{loading:"正在重载服务器...",success:"重载完毕",error:"重载失败"}),children:(0,n.jsx)(x.A,{})}),(0,n.jsxs)(C.Lt,{children:[(0,n.jsx)(C.tv,{asChild:!0,children:(0,n.jsx)(w.$,{variant:"outline",size:"icon",title:"停止服务器",children:(0,n.jsx)(h.A,{})})}),(0,n.jsxs)(C.EO,{children:[(0,n.jsxs)(C.wd,{children:[(0,n.jsx)(C.r7,{children:"确定要停止服务器吗？"}),(0,n.jsx)(C.$v,{children:"此操作将保存所有服务器信息并关闭服务器，OPanel也将无法访问，之后您可以从后台手动启动服务器。"})]}),(0,n.jsxs)(C.ck,{children:[(0,n.jsx)(C.Zr,{children:"取消"}),(0,n.jsx)(C.Rx,{onClick:()=>{(0,d.ow)("/api/control/stop"),l.oR.loading("正在停止服务器...")},children:"确定"})]})]})]})]})]})]})}var S=r(17580),O=r(6874),P=r.n(O),q=r(13052);function I(e){let{title:t,moreLink:r,className:s,innerClassName:a,children:l,...o}=e;return(0,n.jsxs)(m.Zp,{className:(0,f.cn)(s,"!p-0 flex flex-col gap-3 rounded-md"),children:[(0,n.jsxs)("div",{className:"p-4 pb-0 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,n.jsx)(o.icon,{size:20}),(0,n.jsx)("h2",{className:"text-lg font-semibold",children:t})]}),r&&(0,n.jsx)(w.$,{variant:"ghost",size:"sm",className:"text-muted-foreground cursor-pointer",asChild:!0,children:(0,n.jsxs)(P(),{href:r,children:["更多",(0,n.jsx)(q.A,{})]})})]}),(0,n.jsx)("div",{className:(0,f.cn)(a,"overflow-auto"),children:l})]})}var z=r(88524),F=r(37777);function H(e){let{className:t}=e,r=(0,s.useContext)(i);return(0,n.jsx)(I,{icon:S.A,title:"在线玩家 (".concat(r?r.onlinePlayers.length:0," / ").concat(null==r?void 0:r.maxPlayerCount,")"),moreLink:"/panel/players",className:t,innerClassName:"p-4 pt-0",children:(0,n.jsxs)(z.XI,{children:[(0,n.jsx)(z.A0,{children:(0,n.jsxs)(z.Hj,{children:[(0,n.jsx)(z.nd,{children:"玩家"}),(0,n.jsx)(z.nd,{className:"text-center",children:"游戏模式"}),(0,n.jsx)(z.nd,{className:"text-right",children:"延迟"})]})}),(0,n.jsx)(z.BF,{children:r&&r.onlinePlayers.map((e,t)=>{let{name:r,uuid:s,gamemode:a,ping:l}=e;return(0,n.jsxs)(z.Hj,{children:[(0,n.jsx)(z.nA,{className:"font-semibold",children:(0,n.jsxs)(F.m_,{children:[(0,n.jsx)(F.k$,{children:r}),(0,n.jsx)(F.ZI,{children:s})]})}),(0,n.jsx)(z.nA,{className:"text-center",children:(0,f.Cq)(a)}),(0,n.jsx)(z.nA,{className:(0,f.cn)("font-[Consolas] text-right",l<100?"text-green-600":l<200?"text-yellow-600":"text-red-700"),children:l+"ms"})]},t)})})]})})}var M=r(93490),W=r(94754),V=r(87156),Z=r(52071),B=r(46697),$=r(83540),G=r(38124),J=r(12319);let X={light:"",dark:".dark"},K=s.createContext(null);function D(e){let{id:t,className:r,children:a,config:l,...o}=e,i=s.useId(),c="chart-".concat(null!=t?t:i.replace(/:/g,""));return(0,n.jsx)(K.Provider,{value:{config:l},children:(0,n.jsxs)("div",{"data-slot":"chart","data-chart":c,className:(0,f.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",r),...o,children:[(0,n.jsx)(Q,{id:c,config:l}),(0,n.jsx)($.u,{children:a})]})})}let Q=e=>{let{id:t,config:r}=e,s=Object.entries(r).filter(e=>{var t;let[,r]=e;return null!=(t=r.theme)?t:r.color});return s.length?(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(X).map(e=>{let[r,n]=e;return"\n".concat(n," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t,n;let[s,a]=e,l=null!=(n=null==(t=a.theme)?void 0:t[r])?n:a.color;return l?"  --color-".concat(s,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},U=G.m;function Y(e){let{active:t,className:r,indicator:a="dot",hideLabel:l=!1,hideIndicator:o=!1,labelFormatter:i,labelClassName:c,formatter:d,color:u,nameKey:x,labelKey:h,payload:m,label:p}=e,{config:j}=function(){let e=s.useContext(K);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),v=s.useMemo(()=>{var e,t,r,s;if(l||!(null==m?void 0:m.length))return null;let[a]=m,o="".concat(null!=(r=null!=(t=null!=h?h:null==a?void 0:a.dataKey)?t:null==a?void 0:a.name)?r:"value"),d=ee(j,a,o),u=h||"string"!=typeof p?null==d?void 0:d.label:null!=(s=null==(e=j[p])?void 0:e.label)?s:p;return i?(0,n.jsx)("div",{className:(0,f.cn)("font-medium",c),children:i(u,m)}):u?(0,n.jsx)("div",{className:(0,f.cn)("font-medium",c),children:u}):null},[j,l,p,c,i,h,m]);if(!t||!(null==m?void 0:m.length))return null;let g=1===m.length&&"dot"!==a;return(0,n.jsxs)("div",{className:(0,f.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[g?null:v,(0,n.jsx)("div",{className:"grid gap-1.5",children:m.map((e,t)=>{var r,s,l,i,c;let h="".concat(null!=(l=null!=(s=null!=x?x:e.name)?s:e.dataKey)?l:"value"),m=ee(j,e,h),p=null!=(i=null!=u?u:null==(r=e.payload)?void 0:r.fill)?i:e.color;return(0,n.jsx)("div",{className:(0,f.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===a&&"items-center"),children:d&&(null==e?void 0:e.value)!==void 0&&e.name?d(e.value,e.name,e,t,e.payload):(0,n.jsxs)(n.Fragment,{children:[(null==m?void 0:m.icon)?(0,n.jsx)(m.icon,{}):!o&&(0,n.jsx)("div",{className:(0,f.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===a,"w-1":"line"===a,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===a,"my-0.5":g&&"dashed"===a}),style:{"--color-bg":p,"--color-border":p}}),(0,n.jsxs)("div",{className:(0,f.cn)("flex flex-1 justify-between leading-none",g?"items-end":"items-center"),children:[(0,n.jsxs)("div",{className:"grid gap-1.5",children:[g?v:null,(0,n.jsx)("span",{className:"text-muted-foreground",children:null!=(c=null==m?void 0:m.label)?c:e.name})]}),null!=e.value&&(0,n.jsx)("span",{className:"font-mono font-medium text-foreground tabular-nums",children:"number"==typeof e.value?e.value.toLocaleString():String(e.value)})]})]})},t)})})]})}function ee(e,t,r){if("object"!=typeof t||null===t)return;let n="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=r;return r in t&&"string"==typeof t[r]?s=t[r]:n&&r in n&&"string"==typeof n[r]&&(s=n[r]),s in e?e[s]:e[r]}J.s;let et={memory:{label:"内存占用"},cpu:{label:"CPU占用"}};function er(e){let{className:t}=e,r=(0,s.useContext)(c);return(0,n.jsx)(I,{icon:B.A,title:"资源监控",className:(0,f.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,n.jsx)(D,{config:et,className:"w-full max-h-96",children:(0,n.jsxs)(M.Q,{accessibilityLayer:!0,data:r,margin:{left:0,right:0,bottom:80},children:[(0,n.jsx)(W.d,{vertical:!1,stroke:"var(--border)"}),(0,n.jsx)(V.Gk,{dataKey:"memory",type:"monotone",fill:"url(#fillMemory)",stroke:"var(--color-chart-2)",strokeWidth:"2",isAnimationActive:!1}),(0,n.jsx)(V.Gk,{dataKey:"cpu",type:"monotone",fill:"url(#fillCpu)",stroke:"var(--color-foreground)",strokeWidth:"2",isAnimationActive:!1}),(0,n.jsx)(Z.h,{hide:!0,domain:[0,100]}),(0,n.jsx)(U,{cursor:!1,content:(0,n.jsx)(Y,{hideLabel:!0,indicator:"line"})}),(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"fillMemory",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"10%",stopColor:"var(--color-chart-2)"}),(0,n.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})}),(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"fillCpu",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"10%",stopColor:"var(--color-foreground)"}),(0,n.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})})]})})})}var en=r(35695),es=r(62978),ea=r(89852),el=r(55424),eo=r(14657);function ei(e){let{className:t}=e,{push:r}=(0,en.useRouter)(),s=(0,el.A)();return(0,n.jsxs)(I,{icon:es.A,title:"服务器后台",moreLink:"/panel/terminal",className:t,innerClassName:"p-2 pt-0 h-full flex flex-col gap-2 overflow-hidden",children:[(0,n.jsx)(eo.e,{client:s,simple:!0,className:"flex-1"}),(0,n.jsx)(ea.p,{className:"w-full rounded-sm cursor-pointer",placeholder:"发送消息 / 指令...",title:"转至后台页面",onClick:()=>r("/panel/terminal")})]})}var ec=r(25487);let ed={tps:{label:"TPS"}};function eu(e){let{className:t}=e,r=(0,s.useContext)(c);return(0,n.jsx)(I,{icon:ec.A,title:"TPS监控",className:(0,f.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,n.jsx)(D,{config:ed,className:"w-full max-h-20",children:(0,n.jsxs)(M.Q,{accessibilityLayer:!0,data:r,margin:{left:0,right:0,bottom:20},children:[(0,n.jsx)(W.d,{vertical:!1,stroke:"var(--border)"}),(0,n.jsx)(V.Gk,{dataKey:"tps",type:"monotone",fill:"transparent",stroke:"var(--color-chart-3)",strokeWidth:"2",isAnimationActive:!1}),(0,n.jsx)(Z.h,{hide:!0,domain:[0,20]}),(0,n.jsx)(U,{cursor:!1,content:(0,n.jsx)(Y,{hideLabel:!0,indicator:"line"})})]})})})}function ex(){let[e,t]=(0,s.useState)(),[r,u]=(0,s.useState)(Array(50).fill({memory:0,cpu:0,tps:20})),x=async()=>{try{let e=await (0,d.qV)("/api/info");t(e)}catch(e){l.oR.error("无法连接到服务器")}},h=async()=>{let e=[...await (0,f.LJ)(u)],{mem:t,cpu:r,tps:n}=await (0,d.qV)("/api/monitor");e.shift(),e.push({memory:t,cpu:r,tps:n}),u(e)};return(0,s.useEffect)(()=>{x()},[]),(0,s.useEffect)(()=>{let e=setInterval(()=>{h()},2e3);return()=>clearInterval(e)},[]),(0,n.jsx)(o.C,{title:"仪表盘",icon:(0,n.jsx)(a.A,{}),className:"h-[600px] grid grid-rows-4 grid-cols-3 gap-3 pb-20 [&>*]:p-4",children:(0,n.jsx)(i.Provider,{value:e,children:(0,n.jsxs)(c.Provider,{value:r,children:[(0,n.jsx)(T,{className:"row-start-1 col-span-2"}),(0,n.jsx)(H,{className:"row-span-3 row-start-2"}),(0,n.jsx)(er,{className:"row-span-2 row-start-2"}),(0,n.jsx)(eu,{className:"row-start-4"}),(0,n.jsx)(ei,{className:"row-span-4"})]})})})}},55424:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(12115),s=r(16453),a=r(56671),l=r(31886);class o{init(){var e,t,r;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected."),this.send({type:"auth",data:(0,s.getCookie)("token")})}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e)}),null==(r=this.socket)||r.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:r,data:n}=JSON.parse(t.data);if(console.log("[Terminal] "+n.line),"init"===r&&!(n instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===r)throw a.oR.error("Packet Error",{description:n}),Error("Packet error: "+n);e(r,n)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){if(this.socket=null,!(0,s.hasCookie)("token"))throw Error("No authentication token found.");this.socket=new WebSocket(l.yq+"/terminal"),this.init()}}function i(){let[e,t]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=new o;return t(e),()=>e.close()},[]),e}},71365:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,k:()=>s});let n="INFO";function s(e){switch(e){case"INFO":return 1;case"WARN":return 2;case"ERROR":return 3}}},88145:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var n=r(95155);r(12115);var s=r(99708),a=r(74466),l=r(53999);let o=(0,a.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,asChild:a=!1,...i}=e,c=a?s.DX:"span";return(0,n.jsx)(c,{"data-slot":"badge",className:(0,l.cn)(o({variant:r}),t),...i})}},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>i,Wu:()=>c,ZB:()=>o,Zp:()=>a,aR:()=>l,wL:()=>d});var n=r(95155);r(12115);var s=r(53999);function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",t),...r})}},88524:(e,t,r)=>{"use strict";r.d(t,{A0:()=>l,BF:()=>o,Hj:()=>i,XI:()=>a,nA:()=>d,nd:()=>c});var n=r(95155);r(12115);var s=r(53999);function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,n.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",t),...r})})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}}},e=>{var t=t=>e(e.s=t);e.O(0,[379,455,370,702,671,464,874,164,641,90,193,441,684,358],()=>t(14133)),_N_E=e.O()}]);