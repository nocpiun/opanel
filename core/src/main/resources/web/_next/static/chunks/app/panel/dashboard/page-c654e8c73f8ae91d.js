(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{14133:(e,t,r)=>{Promise.resolve().then(r.bind(r,60441))},14657:(e,t,r)=>{"use strict";r.d(t,{e:()=>c});var s=r(95155),n=r(12115),l=r(28916),a=r(53999),i=r(71365);function o(e){let t,{time:r,level:n,thread:i,source:o,line:c,simple:d,visible:u}=e,x=o.split("."),m=x[x.length-1];switch(n){case"INFO":t="text-green-700 dark:text-green-500";break;case"WARN":t="text-yellow-700 dark:text-yellow-600";break;case"ERROR":t="text-red-700 dark:text-red-400"}return(0,s.jsxs)("p",{className:(0,a.cn)("text-xs text-nowrap font-[Consolas] space-x-1",u?"":"hidden"),children:[(0,s.jsx)("span",{className:"text-blue-500 dark:text-blue-400",children:"[".concat((0,l.GP)(new Date(r),"HH:mm:ss"),"]")}),!d&&(0,s.jsx)("span",{className:t,children:"[".concat(i,"/").concat(n,"]")}),!d&&(0,s.jsx)("span",{className:"text-emerald-600 dark:text-emerald-500 max-md:hidden",children:"(".concat(m,")")}),(0,s.jsx)("span",{children:c})]})}function c(e){let{client:t,simple:r,level:l,className:c}=e,d=(0,n.useRef)(null),[u,x]=(0,n.useState)([]),m=e=>{x(t=>[...t,e])},h=()=>{d.current&&(d.current.innerHTML="")};return(0,n.useEffect)(()=>{if(!d.current)return;let e=d.current;e.scrollTo({top:e.scrollHeight})},[u]),(0,n.useEffect)(()=>{if(t)return t.onMessage((e,t)=>{switch(e){case"init":for(let e of t)m(e);break;case"log":m(t)}}),()=>h()},[t]),(0,s.jsx)("div",{className:(0,a.cn)(c,"border rounded-sm bg-background overflow-auto p-2"),ref:d,children:u.map((e,t)=>(0,n.createElement)(o,{...e,simple:r,visible:(0,i.k)(e.level)>=(0,i.k)(null!=l?l:i.I),key:t}))})}},16268:(e,t,r)=>{"use strict";r.d(t,{q:()=>l,r:()=>a});let s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=["k","l","m","n","o"];function l(e){return e.replaceAll("\xa7","\xc2\xa7")}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.replaceAll("\xc2",""),l=document.createElement("span");l.className="cc-root";let a=l,i=1;for(let e=0;e<r.length;e++){let o=r[e];if("\n"===o&&i<t){a.appendChild(document.createElement("br")),i++;continue}if("\xa7"===o){let t=r[e+1];if("r"===t){a=l,e++;continue}let i=s.includes(t),o=n.includes(t);if(!i&&!o)continue;i&&(a=l);let c=document.createElement("span");c.className="cc-".concat(t),a.appendChild(c),a=c,e++}else a.innerHTML+=o}return l}},27450:(e,t,r)=>{"use strict";r.d(t,{F:()=>v});var s=r(95155);r(12115);var n=r(17649),l=r(53999),a=r(97168);function i(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"alert-dialog",...t})}function o(e){let{...t}=e;return(0,s.jsx)(n.l9,{"data-slot":"alert-dialog-trigger",...t})}function c(e){let{...t}=e;return(0,s.jsx)(n.ZL,{"data-slot":"alert-dialog-portal",...t})}function d(e){let{className:t,...r}=e;return(0,s.jsx)(n.hJ,{"data-slot":"alert-dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function u(e){let{className:t,...r}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(d,{}),(0,s.jsx)(n.UC,{"data-slot":"alert-dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r})]})}function x(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...r})}function m(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function h(e){let{className:t,...r}=e;return(0,s.jsx)(n.hE,{"data-slot":"alert-dialog-title",className:(0,l.cn)("text-lg font-semibold",t),...r})}function f(e){let{className:t,...r}=e;return(0,s.jsx)(n.VY,{"data-slot":"alert-dialog-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...r})}function p(e){let{className:t,...r}=e;return(0,s.jsx)(n.rc,{className:(0,l.cn)((0,a.r)(),t),...r})}function j(e){let{className:t,...r}=e;return(0,s.jsx)(n.ZD,{className:(0,l.cn)((0,a.r)({variant:"outline"}),t),...r})}function v(e){let{title:t,description:r,cancellable:n=!0,onAction:l,asChild:a,children:c}=e;return(0,s.jsxs)(i,{children:[(0,s.jsx)(o,{asChild:a,children:c}),(0,s.jsxs)(u,{children:[(0,s.jsxs)(x,{children:[(0,s.jsx)(h,{children:t}),r&&(0,s.jsx)(f,{children:r})]}),(0,s.jsxs)(m,{children:[n&&(0,s.jsx)(j,{children:"取消"}),(0,s.jsx)(p,{onClick:()=>{l&&l()},children:"确定"})]})]})]})}},55424:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(12115),n=r(16453),l=r(56671),a=r(31886);class i{init(){var e,t,r;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected."),this.send({type:"auth",data:(0,n.getCookie)("token")})}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e),l.oR.error("无法连接到终端WebSocket")}),null==(r=this.socket)||r.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:r,data:s}=JSON.parse(t.data);if(console.log("[Terminal] "+s.line),"init"===r&&!(s instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===r)throw l.oR.error("Packet Error",{description:s}),Error("Packet error: "+s);e(r,s)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){this.socket=null,(0,n.hasCookie)("token")||(window.location.href="/login"),this.socket=new WebSocket(a.yq+"/terminal"),this.init()}}function o(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=new i;return t(e),()=>e.close()},[]),e}},60441:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eg});var s=r(95155),n=r(12115),l=r(98611);let a=function(){let e=n.createContext(void 0);return e.displayName="APIContext",e}(),i=n.createContext(void 0);i.displayName="APIContext";var o=r(31886),c=r(53999),d=r(17881),u=r(44940),x=r(381),m=r(32568),h=r(27265),f=r(56671),p=r(88482),j=r(95011),v=r(88145),g=r(97168),b=r(27450),N=r(86801),k=r(91364),w=r(51362),y=r(41085);function C(e){let{children:t,asChild:r}=e,[l,a]=(0,n.useState)(""),{theme:i}=(0,w.D)(),c=(0,n.useRef)(null),d=async()=>{try{let e=await (0,o.qV)("/api/control/properties");a(e.properties)}catch(e){(0,o.Kf)(e,"无法获取server.properties",[[401,"未登录"],[500,"服务器内部错误"]])}},u=async()=>{if(c.current&&c.current.getValue()!==l)try{await (0,o.ow)("/api/control/properties",c.current.getValue()),f.oR.success("保存成功",{description:"重启服务器以使改动生效"})}catch(e){(0,o.Kf)(e,"无法保存server.properties",[[401,"未登录"],[500,"服务器内部错误"]])}};return(0,s.jsxs)(y.cj,{onOpenChange:e=>e&&d(),children:[(0,s.jsx)(y.CG,{asChild:r,children:t}),(0,s.jsxs)(y.h,{children:[(0,s.jsxs)(y.Fm,{children:[(0,s.jsx)(y.qp,{children:"编辑 server.properties"}),(0,s.jsxs)(y.Qs,{children:["在此编辑服务器配置文件，你也可以直接编辑服务器目录下的",(0,s.jsx)("code",{children:"server.properties"}),"文件。"]})]}),(0,s.jsx)("div",{className:"flex flex-col h-full",children:(0,s.jsx)(k.KE,{defaultLanguage:"ini",defaultValue:l,theme:"dark"===i?"vs-dark":"vs",options:{minimap:{enabled:!1},automaticLayout:!0},onMount:e=>c.current=e})}),(0,s.jsxs)(y.XW,{children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"需重启服务器以使改动生效。"}),(0,s.jsx)(y.kN,{asChild:!0,children:(0,s.jsx)(g.$,{className:"cursor-pointer",onClick:()=>u(),children:"保存设置"})})]})]})]})}var A=r(62177),E=r(71153),_=r(48778),L=r(99840),M=r(30070);function z(e){let{className:t,...r}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}var S=r(16268);let R=E.z.object({motd:E.z.string().nonempty("Motd不可为空").refine(e=>e.split("\n").length<=2,"Motd行数最大为2")});function P(e){let{motd:t,asChild:r,children:n}=e,l=(0,A.mN)({resolver:(0,_.u)(R),values:{motd:t}}),a=async e=>{try{await (0,o.ow)("/api/info/motd",btoa((0,S.q)(e.motd))),window.location.reload()}catch(e){(0,o.Kf)(e,"修改Motd失败",[[400,"请求参数错误"],[401,"未登录"],[500,"服务器内部错误"]])}};return(0,s.jsxs)(L.lG,{children:[(0,s.jsx)(L.zM,{asChild:r,children:n}),(0,s.jsx)(L.Cf,{children:(0,s.jsx)(M.lV,{...l,children:(0,s.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:l.handleSubmit(a),children:[(0,s.jsxs)(L.c7,{children:[(0,s.jsx)(L.L3,{children:"编辑 Motd"}),(0,s.jsx)(L.rr,{children:"在此编辑和预览服务器 Motd。"})]}),(0,s.jsx)(M.zB,{control:l.control,name:"motd",render:e=>{let{field:t}=e;return(0,s.jsxs)(M.eI,{children:[(0,s.jsx)(M.MJ,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 overflow-hidden",children:[(0,s.jsx)(j.Z,{maxLines:2,className:"wrap-anywhere",children:"\xa77"+t.value}),(0,s.jsx)(z,{...t,rows:2,placeholder:"请输入文本..."})]})}),(0,s.jsx)(M.C5,{})]})}}),(0,s.jsxs)(L.Es,{className:"flex flex-row !justify-between",children:[(0,s.jsx)(g.$,{type:"button",variant:"outline",size:"icon",className:"cursor-pointer",onClick:()=>l.setValue("motd",l.getValues().motd+"\xa7"),children:"\xa7"}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsx)(L.HM,{asChild:!0,children:(0,s.jsx)(g.$,{variant:"outline",onClick:()=>l.reset(),children:"取消"})}),(0,s.jsx)(L.HM,{asChild:!0,children:(0,s.jsx)(g.$,{type:"submit",children:"保存"})})]})]})]})})})]})}let T={src:"/_next/static/media/pack.3fda983d.png"};function I(e){var t;let{className:r}=e,l=(0,n.useContext)(a);return(0,s.jsxs)("div",{className:(0,c.cn)("flex gap-1 [&>*]:cursor-pointer",r),children:[(null==l?void 0:l.whitelist)&&(0,s.jsx)(N.T,{asChild:!0,children:(0,s.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑白名单",children:(0,s.jsx)(d.A,{})})}),(0,s.jsx)(P,{motd:atob(null!=(t=null==l?void 0:l.motd)?t:""),asChild:!0,children:(0,s.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑Motd",children:(0,s.jsx)(u.A,{})})}),(0,s.jsx)(C,{asChild:!0,children:(0,s.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑server.properties",children:(0,s.jsx)(x.A,{})})}),(0,s.jsx)(g.$,{variant:"ghost",size:"icon",title:"重载服务器",onClick:()=>f.oR.promise((0,o.ow)("/api/control/reload"),{loading:"正在重载服务器...",success:"重载完毕",error:"重载失败"}),children:(0,s.jsx)(m.A,{})}),(0,s.jsx)(b.F,{title:"确定要停止服务器吗？",description:"此操作将保存所有服务器信息并关闭服务器，OPanel也将无法访问，之后您可以从后台手动启动服务器。",onAction:()=>{(0,o.ow)("/api/control/stop"),f.oR.loading("正在停止服务器...")},asChild:!0,children:(0,s.jsx)(g.$,{variant:"outline",size:"icon",title:"停止服务器",children:(0,s.jsx)(h.A,{})})})]})}function O(e){let{className:t}=e,r=(0,n.useContext)(a);return(0,s.jsxs)(p.Zp,{className:(0,c.cn)(t,"flex flex-col max-sm:gap-3"),children:[(0,s.jsxs)("div",{className:"min-sm:flex-1 flex gap-6 max-sm:border-b max-sm:pb-3",children:[(0,s.jsx)("img",{className:"aspect-square h-full rounded-xs image-pixelated",src:r&&r.favicon?o.y0+r.favicon:T.src,alt:"favicon"}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex gap-4 [&>*]:space-x-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold text-nowrap",children:"版本:"}),(0,s.jsx)("span",{children:null==r?void 0:r.version})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold text-nowrap",children:"端口:"}),(0,s.jsx)("span",{className:"text-emerald-500 font-[Consolas]",children:r?r.port:""})]})]}),(0,s.jsx)("div",{className:"h-fit text-sm",children:r&&(0,s.jsx)(j.Z,{maxLines:2,children:"\xa77"+atob(r.motd)})})]}),(0,s.jsxs)("div",{className:"flex flex-col justify-between",children:[(0,s.jsxs)(v.E,{className:"self-end max-sm:hidden",variant:"outline",children:[(0,s.jsx)("div",{className:(0,c.cn)("w-2 h-2 rounded-full",r?"bg-green-600":"bg-red-700")}),r?"正在运行":"未运行"]}),(0,s.jsx)(I,{className:"self-end max-sm:hidden"})]})]}),(0,s.jsx)(I,{className:"hidden flex-row-reverse self-start max-sm:flex"})]})}var H=r(17580),W=r(6874),q=r.n(W),F=r(13052);function K(e){let{title:t,moreLink:r,className:n,innerClassName:l,children:a,...i}=e;return(0,s.jsxs)(p.Zp,{className:(0,c.cn)(n,"!p-0 flex flex-col gap-3 rounded-md"),children:[(0,s.jsxs)("div",{className:"p-4 pb-0 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,s.jsx)(i.icon,{size:20}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:t})]}),r&&(0,s.jsx)(g.$,{variant:"ghost",size:"sm",className:"text-muted-foreground cursor-pointer",asChild:!0,children:(0,s.jsxs)(q(),{href:r,children:["更多",(0,s.jsx)(F.A,{})]})})]}),(0,s.jsx)("div",{className:(0,c.cn)(l,"overflow-auto"),children:a})]})}var V=r(88524),Z=r(37777);function $(e){let{className:t}=e,r=(0,n.useContext)(a);return(0,s.jsx)(K,{icon:H.A,title:"在线玩家 (".concat(r?r.onlinePlayers.length:0," / ").concat(null==r?void 0:r.maxPlayerCount,")"),moreLink:"/panel/players",className:t,innerClassName:"p-4 pt-0",children:(0,s.jsxs)(V.XI,{children:[(0,s.jsx)(V.A0,{children:(0,s.jsxs)(V.Hj,{children:[(0,s.jsx)(V.nd,{children:"玩家"}),(0,s.jsx)(V.nd,{className:"text-center",children:"游戏模式"}),(0,s.jsx)(V.nd,{className:"text-right",children:"延迟"})]})}),(0,s.jsx)(V.BF,{children:r&&r.onlinePlayers.map((e,t)=>{let{name:r,uuid:n,gamemode:l,ping:a}=e;return(0,s.jsxs)(V.Hj,{children:[(0,s.jsx)(V.nA,{className:"font-semibold",children:(0,s.jsxs)(Z.m_,{children:[(0,s.jsx)(Z.k$,{children:r}),(0,s.jsx)(Z.ZI,{children:n})]})}),(0,s.jsx)(V.nA,{className:"text-center",children:(0,c.Cq)(l)}),(0,s.jsx)(V.nA,{className:(0,c.cn)("font-[Consolas] text-right",a<100?"text-green-600":a<200?"text-yellow-600":"text-red-700"),children:a+"ms"})]},t)})})]})})}var G=r(93490),B=r(94754),J=r(87156),D=r(52071),Q=r(46697),U=r(83540),X=r(38124),Y=r(12319);let ee={light:"",dark:".dark"},et=n.createContext(null);function er(e){let{id:t,className:r,children:l,config:a,...i}=e,o=n.useId(),d="chart-".concat(null!=t?t:o.replace(/:/g,""));return(0,s.jsx)(et.Provider,{value:{config:a},children:(0,s.jsxs)("div",{"data-slot":"chart","data-chart":d,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",r),...i,children:[(0,s.jsx)(es,{id:d,config:a}),(0,s.jsx)(U.u,{children:l})]})})}let es=e=>{let{id:t,config:r}=e,n=Object.entries(r).filter(e=>{var t;let[,r]=e;return null!=(t=r.theme)?t:r.color});return n.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(ee).map(e=>{let[r,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(n.map(e=>{var t,s;let[n,l]=e,a=null!=(s=null==(t=l.theme)?void 0:t[r])?s:l.color;return a?"  --color-".concat(n,": ").concat(a,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},en=X.m;function el(e){let{active:t,className:r,indicator:l="dot",hideLabel:a=!1,hideIndicator:i=!1,labelFormatter:o,labelClassName:d,formatter:u,color:x,nameKey:m,labelKey:h,payload:f,label:p}=e,{config:j}=function(){let e=n.useContext(et);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),v=n.useMemo(()=>{var e,t,r,n;if(a||!(null==f?void 0:f.length))return null;let[l]=f,i="".concat(null!=(r=null!=(t=null!=h?h:null==l?void 0:l.dataKey)?t:null==l?void 0:l.name)?r:"value"),u=ea(j,l,i),x=h||"string"!=typeof p?null==u?void 0:u.label:null!=(n=null==(e=j[p])?void 0:e.label)?n:p;return o?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",d),children:o(x,f)}):x?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",d),children:x}):null},[j,a,p,d,o,h,f]);if(!t||!(null==f?void 0:f.length))return null;let g=1===f.length&&"dot"!==l;return(0,s.jsxs)("div",{className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[g?null:v,(0,s.jsx)("div",{className:"grid gap-1.5",children:f.map((e,t)=>{var r,n,a,o,d;let h="".concat(null!=(a=null!=(n=null!=m?m:e.name)?n:e.dataKey)?a:"value"),f=ea(j,e,h),p=null!=(o=null!=x?x:null==(r=e.payload)?void 0:r.fill)?o:e.color;return(0,s.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===l&&"items-center"),children:u&&(null==e?void 0:e.value)!==void 0&&e.name?u(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==f?void 0:f.icon)?(0,s.jsx)(f.icon,{}):!i&&(0,s.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===l,"w-1":"line"===l,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===l,"my-0.5":g&&"dashed"===l}),style:{"--color-bg":p,"--color-border":p}}),(0,s.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",g?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[g?v:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:null!=(d=null==f?void 0:f.label)?d:e.name})]}),null!=e.value&&(0,s.jsx)("span",{className:"font-mono font-medium text-foreground tabular-nums",children:"number"==typeof e.value?e.value.toLocaleString():String(e.value)})]})]})},t)})})]})}function ea(e,t,r){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,n=r;return r in t&&"string"==typeof t[r]?n=t[r]:s&&r in s&&"string"==typeof s[r]&&(n=s[r]),n in e?e[n]:e[r]}Y.s;let ei={memory:{label:"内存占用"},cpu:{label:"CPU占用"}};function eo(e){let{className:t}=e,r=(0,n.useContext)(i);return(0,s.jsx)(K,{icon:Q.A,title:"资源监控",className:(0,c.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,s.jsx)(er,{config:ei,className:"w-full max-h-96",children:(0,s.jsxs)(G.Q,{accessibilityLayer:!0,data:r,margin:{left:0,right:0,bottom:80},children:[(0,s.jsx)(B.d,{vertical:!1,stroke:"var(--border)"}),(0,s.jsx)(J.Gk,{dataKey:"memory",type:"monotone",fill:"url(#fillMemory)",stroke:"var(--color-chart-2)",strokeWidth:"2",isAnimationActive:!1}),(0,s.jsx)(J.Gk,{dataKey:"cpu",type:"monotone",fill:"url(#fillCpu)",stroke:"var(--color-foreground)",strokeWidth:"2",isAnimationActive:!1}),(0,s.jsx)(D.h,{hide:!0,domain:[0,100]}),(0,s.jsx)(en,{cursor:!1,content:(0,s.jsx)(el,{hideLabel:!0,indicator:"line"})}),(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"fillMemory",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"10%",stopColor:"var(--color-chart-2)"}),(0,s.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})}),(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"fillCpu",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"10%",stopColor:"var(--color-foreground)"}),(0,s.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})})]})})})}var ec=r(35695),ed=r(62978),eu=r(89852),ex=r(55424),em=r(14657);function eh(e){let{className:t}=e,{push:r}=(0,ec.useRouter)(),n=(0,ex.A)();return(0,s.jsxs)(K,{icon:ed.A,title:"服务器后台",moreLink:"/panel/terminal",className:t,innerClassName:"p-2 pt-0 h-full flex flex-col gap-2 overflow-hidden",children:[(0,s.jsx)(em.e,{client:n,simple:!0,className:"flex-1"}),(0,s.jsx)(eu.p,{className:"w-full rounded-sm cursor-pointer",placeholder:"发送消息 / 指令...",title:"转至后台页面",onClick:()=>r("/panel/terminal")})]})}var ef=r(25487);let ep={tps:{label:"TPS"}};function ej(e){let{className:t}=e,r=(0,n.useContext)(i);return(0,s.jsx)(K,{icon:ef.A,title:"TPS监控",className:(0,c.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,s.jsx)(er,{config:ep,className:"w-full max-h-20",children:(0,s.jsxs)(G.Q,{accessibilityLayer:!0,data:r,margin:{left:0,right:0,bottom:20},children:[(0,s.jsx)(B.d,{vertical:!1,stroke:"var(--border)"}),(0,s.jsx)(J.Gk,{dataKey:"tps",type:"monotone",fill:"transparent",stroke:"var(--color-chart-3)",strokeWidth:"2",isAnimationActive:!1}),(0,s.jsx)(D.h,{hide:!0,domain:[0,20]}),(0,s.jsx)(en,{cursor:!1,content:(0,s.jsx)(el,{hideLabel:!0,indicator:"line"})})]})})})}var ev=r(24232);function eg(){let[e,t]=(0,n.useState)(),[r,d]=(0,n.useState)(Array(50).fill({memory:0,cpu:0,tps:20})),u=async()=>{try{let e=await (0,o.qV)("/api/info");t(e)}catch(e){(0,o.Kf)(e,"无法连接到服务器",[[401,"未登录"],[500,"服务器内部错误"]])}},x=async()=>{let e=[...await (0,c.LJ)(d)],{mem:t,cpu:r,tps:s}=await (0,o.qV)("/api/monitor");e.shift(),e.push({memory:t,cpu:r,tps:s}),d(e)};return(0,n.useEffect)(()=>{u()},[]),(0,n.useEffect)(()=>{let e=setInterval(()=>{x()},2e3);return()=>clearInterval(e)},[]),(0,s.jsx)(ev.C,{title:"仪表盘",icon:(0,s.jsx)(l.A,{}),className:"h-[600px] grid grid-rows-4 grid-cols-3 max-xl:flex flex-col gap-3 pb-20 [&>*]:p-4",children:(0,s.jsx)(a.Provider,{value:e,children:(0,s.jsxs)(i.Provider,{value:r,children:[(0,s.jsx)(O,{className:"row-start-1 col-span-2"}),(0,s.jsx)($,{className:"row-span-3 row-start-2"}),(0,s.jsx)(eo,{className:"row-span-2 row-start-2"}),(0,s.jsx)(ej,{className:"row-start-4"}),(0,s.jsx)(eh,{className:"row-span-4 max-sm:hidden"})]})})})}},71365:(e,t,r)=>{"use strict";r.d(t,{I:()=>s,k:()=>n});let s="INFO";function n(e){switch(e){case"INFO":return 1;case"WARN":return 2;case"ERROR":return 3}}},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>a,wL:()=>d});var s=r(95155);r(12115);var n=r(53999);function l(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function a(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function i(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...r})}function o(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center px-6 [.border-t]:pt-6",t),...r})}},95011:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var s=r(95155),n=r(12115),l=r(16268),a=r(53999);let i="|i!:;.";function o(e){return" "===e?" ":i.includes(e)?(0,a.gI)(i.split("")):(0,a.gI)("+/\\=023456789ABCDEFGHJKLMNOPQRSTUVWXYZabcdeghjmnopqrsuvwxyz\xa2\xa3\xa5\xb1\xb5\xc0\xc1\xc2\xc3\xc4\xc5\xc7\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xeb".split(""))}var c=r(21509),d=r.n(c),u=r(4424),x=r.n(u),m=r(4852),h=r.n(m);function f(e){let{maxLines:t,children:r,className:i}=e,c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(c.current)for(let e of(c.current.innerHTML="",c.current.appendChild((0,l.r)(r,t)),c.current.getElementsByClassName("cc-k")))e instanceof HTMLSpanElement&&function(e){let t=e.innerText,r=()=>{e.innerText=Array.from(t).map(o).join(""),requestAnimationFrame(r)};requestAnimationFrame(r)}(e)},[r,t]),(0,s.jsx)("div",{className:(0,a.cn)("[&_*]:leading-0.5",i,d().className,x().className,h().variable),ref:c})}}},e=>{var t=t=>e(e.s=t);e.O(0,[399,613,455,702,370,671,464,371,874,647,641,376,193,991,441,684,358],()=>t(14133)),_N_E=e.O()}]);