(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{1851:(e,t,r)=>{"use strict";r.d(t,{C:()=>f});var s=r(5155);r(2115);var n=r(3052),l=r(1907);function a(e){let{...t}=e;return(0,s.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...t})}function o(e){let{className:t,...r}=e;return(0,s.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,l.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",t),...r})}function i(e){let{className:t,...r}=e;return(0,s.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,l.cn)("inline-flex items-center gap-1.5",t),...r})}function c(e){let{className:t,...r}=e;return(0,s.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,l.cn)("text-foreground font-normal",t),...r})}function d(e){let{children:t,className:r,...a}=e;return(0,s.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,l.cn)("[&>svg]:size-3.5",r),...a,children:null!=t?t:(0,s.jsx)(n.A,{})})}var u=r(6037),h=r(1196);function f(e){let{children:t,title:r,icon:n,className:l}=e;return(0,s.jsxs)("div",{className:"px-16 flex-1 flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"py-10 flex flex-col gap-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(h.SidebarTrigger,{className:"cursor-pointer"}),(0,s.jsx)(u.Separator,{orientation:"vertical"}),(0,s.jsx)(a,{children:(0,s.jsxs)(o,{children:[(0,s.jsx)(i,{children:"OPanel"}),(0,s.jsx)(d,{}),(0,s.jsx)(i,{children:(0,s.jsx)(c,{children:r})})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[n,(0,s.jsx)("h1",{className:"text-3xl font-bold",children:r})]})]}),(0,s.jsx)("div",{className:l,children:t})]})}},1886:(e,t,r)=>{"use strict";r.d(t,{ow:()=>i,qV:()=>o,y0:()=>l,yq:()=>a});var s=r(3464),n=r(6453);let l="",a=globalThis.window?"ws://".concat(window.location.host):"ws://localhost:3000";async function o(e){return(await s.A.request({method:"get",url:l+e,headers:{"X-Credential-Token":(0,n.getCookie)("token")}})).data}async function i(e,t){let r=t?JSON.stringify(t):"";return(await s.A.request({method:"post",maxBodyLength:1/0,url:l+e,headers:{"Content-Type":"text/plain"},data:r})).data}},2978:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("square-terminal",[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]])},3052:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4657:(e,t,r)=>{"use strict";r.d(t,{e:()=>a});var s=r(5155),n=r(2115),l=r(1907);function a(e){let{client:t,className:r}=e,a=(0,n.useRef)(null),o=e=>{if(!a.current)return;let t=a.current,r=document.createElement("p");r.innerText=e,t.appendChild(r),t.scrollTo({top:t.scrollHeight})};return(0,n.useEffect)(()=>{t&&t.onMessage((e,t)=>{switch(e){case"init":for(let e of t)o(e);break;case"log":o(t)}})},[t]),(0,s.jsx)("div",{className:(0,l.cn)(r,"flex-1 w-full border rounded-sm bg-background overflow-auto p-2 [&>p]:text-xs [&>p]:font-[Consolas]"),ref:a})}},5424:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(2115),n=r(6671),l=r(1886);class a{init(){var e,t,r;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected.")}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e)}),null==(r=this.socket)||r.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:r,data:s}=JSON.parse(t.data);if(console.log("[Terminal] "+s),"init"===r&&!(s instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===r)throw n.oR.error("Packet Error",{description:s}),Error("Packet error: "+s);e(r,s)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){this.socket=null,this.socket=new WebSocket(l.yq+"/terminal"),this.init()}}function o(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=new a;return t(e),()=>e.close()},[]),e}},5661:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(5155),n=r(2115),l=r(2978),a=r(4416);let o=(0,r(9946).A)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var i=r(1851),c=r(5424),d=r(4657),u=r(9852),h=r(7168);function f(){let e=(0,c.A)(),t=(0,n.useRef)(null),r=()=>{t.current&&(t.current.value="")},f=(0,n.useCallback)(()=>{if(!t.current||!e)return;let s=t.current.value;e.send({type:"command",data:s}),r()},[e]);return(0,n.useEffect)(()=>{let e=e=>{"Enter"===e.key&&f()};return document.body.addEventListener("keydown",e),()=>document.body.removeEventListener("keydown",e)},[f]),(0,n.useEffect)(()=>{var e;null==(e=t.current)||e.focus()},[]),(0,s.jsxs)(i.C,{title:"后台",icon:(0,s.jsx)(l.A,{}),className:"h-[500px] flex flex-col gap-3",children:[(0,s.jsx)(d.e,{client:e}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(u.p,{className:"flex-1 w-full rounded-sm font-[Consolas]",placeholder:"发送消息 / 指令...",ref:t}),(0,s.jsx)(h.$,{variant:"ghost",size:"icon",className:"cursor-pointer",title:"清空",onClick:()=>r(),children:(0,s.jsx)(a.A,{})}),(0,s.jsx)(h.$,{size:"icon",className:"cursor-pointer",title:"发送",onClick:()=>f(),children:(0,s.jsx)(o,{})})]})]})}},9505:(e,t,r)=>{Promise.resolve().then(r.bind(r,5661))}},e=>{var t=t=>e(e.s=t);e.O(0,[455,844,702,671,464,196,441,684,358],()=>t(9505)),_N_E=e.O()}]);